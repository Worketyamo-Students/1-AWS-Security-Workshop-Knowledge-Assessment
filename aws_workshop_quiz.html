<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Security Workshop Knowledge Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .quiz-header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .quiz-header h1 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        .quiz-header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .progress-bar {
            background: #ecf0f1;
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #3498db, #2ecc71);
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .question-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: none;
        }

        .question-card.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .section-header h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .section-header p {
            opacity: 0.9;
        }

        .question {
            margin-bottom: 25px;
        }

        .question h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            line-height: 1.4;
        }

        .question-number {
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-right: 10px;
            display: inline-block;
        }

        .options {
            margin-left: 20px;
        }

        .option {
            margin: 12px 0;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: #3498db;
            background: #f8f9ff;
        }

        .option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #2ecc71;
            background: #d5f4e6;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: #ffeaea;
        }

        .option input {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .option label {
            cursor: pointer;
            flex: 1;
        }

        .justification {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            display: none;
        }

        .justification.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .justification h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .navigation {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }

        .score-page {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            display: none;
        }

        .score-page.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: white;
            position: relative;
        }

        .score-excellent {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .score-good {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .score-average {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .score-poor {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .score-details {
            margin: 30px 0;
        }

        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .score-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .recommendations {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }

        .recommendations h3 {
            color: #27ae60;
            margin-bottom: 15px;
        }

        .recommendations ul {
            margin-left: 20px;
        }

        .recommendations li {
            margin: 8px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .quiz-header h1 {
                font-size: 2em;
            }
            
            .question-card, .quiz-header {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Quiz Header -->
        <div class="quiz-header">
            <h1>AWS Security Workshop Knowledge Assessment</h1>
            <p>Test your understanding of AWS security tools, log analysis, and incident response techniques</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <p id="progressText">Question 1 of 20</p>
        </div>

        <!-- Questions will be inserted here -->
        <div id="questionsContainer"></div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>Previous</button>
            <button class="btn" id="nextBtn" onclick="nextQuestion()">Next</button>
            <button class="btn" id="submitBtn" onclick="submitQuiz()" style="display: none;">Submit Quiz</button>
        </div>

        <!-- Score Page -->
        <div class="score-page" id="scorePage">
            <h1>Quiz Complete!</h1>
            <div class="score-circle" id="scoreCircle">
                <span id="scorePercentage">0%</span>
            </div>
            <div class="score-details">
                <h2 id="scoreTitle">Your Performance</h2>
                <p id="scoreDescription">You've completed the AWS Security Workshop Knowledge Assessment</p>
            </div>
            <div class="score-breakdown" id="scoreBreakdown"></div>
            <div class="recommendations" id="recommendations"></div>
            <button class="btn" onclick="restartQuiz()">Retake Quiz</button>
        </div>
    </div>

    <script>
        // Quiz data with questions, options, correct answers, and justifications
        const quizData = [
            {
                section: "AWS CloudFormation",
                description: "Questions about infrastructure as code and resource creation",
                questions: [
                    {
                        id: 1,
                        type: "multiple-choice",
                        question: "What is AWS CloudFormation primarily used for?",
                        options: [
                            "Infrastructure as Code - defining cloud resources in templates",
                            "Database management and optimization", 
                            "Network traffic monitoring",
                            "User authentication and authorization"
                        ],
                        correct: 0,
                        justification: "AWS CloudFormation is Infrastructure as Code (IaC) service that allows you to define cloud resources using JSON or YAML templates. This enables version control, reproducible deployments, and automated resource management."
                    },
                    {
                        id: 2,
                        type: "multiple-choice",
                        question: "Which file format is commonly used for CloudFormation templates?",
                        options: [
                            "JSON and YAML",
                            "XML only",
                            "CSV", 
                            "Plain text"
                        ],
                        correct: 0,
                        justification: "CloudFormation templates can be written in both JSON and YAML formats. YAML is often preferred for its readability, while JSON is more structured. Both formats provide the same functionality."
                    },
                    {
                        id: 3,
                        type: "multiple-choice",
                        question: "What is the primary benefit of using CloudFormation for infrastructure management?",
                        options: [
                            "Version control and reproducible deployments",
                            "Real-time performance monitoring",
                            "Automatic data backup", 
                            "Network security scanning"
                        ],
                        correct: 0,
                        justification: "CloudFormation's primary benefit is enabling Infrastructure as Code with version control and reproducible deployments. This allows teams to track infrastructure changes, ensure consistent deployments across environments, and implement rollback capabilities when needed."
                    },
                    {
                        id: 4,
                        type: "multiple-choice",
                        question: "What CloudFormation concept represents a collection of AWS resources that you can manage as a single unit?",
                        options: [
                            "Stack",
                            "Template",
                            "Resource Group",
                            "Formation"
                        ],
                        correct: 0,
                        justification: "A CloudFormation Stack is a collection of AWS resources that you deploy and manage as a single unit. When you create, update, or delete a stack, you're working with all the resources defined in the template collectively."
                    }
                ]
            },
            {
                section: "Amazon Athena and Log Analysis", 
                description: "Questions about querying log data and identifying indicators of compromise",
                questions: [
                    {
                        id: 5,
                        type: "multiple-choice",
                        question: "Amazon Athena is best described as:",
                        options: [
                            "A serverless interactive query service for analyzing data in S3",
                            "A managed database service",
                            "A container orchestration platform",
                            "A machine learning platform"
                        ],
                        correct: 0,
                        justification: "Amazon Athena is a serverless, interactive query service that makes it easy to analyze data in Amazon S3 using standard SQL. You don't need to set up or manage any infrastructure - just point to your data in S3 and start querying."
                    },
                    {
                        id: 6,
                        type: "multiple-choice", 
                        question: "What query language does Amazon Athena use?",
                        options: [
                            "SQL",
                            "NoSQL",
                            "Python",
                            "JavaScript"
                        ],
                        correct: 0,
                        justification: "Amazon Athena uses standard SQL (ANSI SQL) for querying data. This makes it accessible to anyone familiar with SQL databases and allows for complex analytical queries on structured and semi-structured data."
                    },
                    {
                        id: 7,
                        type: "multiple-choice",
                        question: "Which is the most critical indicator of compromise that can be identified through log analysis?",
                        options: [
                            "Unusual login patterns from foreign IP addresses",
                            "Regular scheduled backups",
                            "Normal business hour access patterns", 
                            "Successful authentication events"
                        ],
                        correct: 0,
                        justification: "Unusual login patterns from foreign IP addresses are critical indicators of compromise. Security teams analyze various log sources to identify these patterns that may indicate malicious activity, unauthorized access attempts, or potential security breaches requiring immediate investigation."
                    },
                    {
                        id: 8,
                        type: "multiple-choice",
                        question: "When investigating a security incident with Athena, what type of logs would be most valuable?",
                        options: [
                            "CloudTrail logs stored in S3",
                            "Application performance logs",
                            "System resource utilization logs",
                            "Network bandwidth monitoring logs"
                        ],
                        correct: 0,
                        justification: "CloudTrail logs stored in S3 are most valuable for security incident investigation. You would use Athena to query these logs looking for unusual API calls from foreign IP addresses, privilege escalation attempts, data exfiltration patterns, failed authentication spikes, and resource access outside normal business hours."
                    }
                ]
            },
            {
                section: "AWS CloudTrail Events",
                description: "Questions about API logging and security monitoring", 
                questions: [
                    {
                        id: 9,
                        type: "multiple-choice",
                        question: "AWS CloudTrail primarily captures:",
                        options: [
                            "API calls and AWS account activity",
                            "Application performance metrics",
                            "Network packet data", 
                            "System resource utilization"
                        ],
                        correct: 0,
                        justification: "AWS CloudTrail records API calls and account activity across your AWS infrastructure. It provides a complete audit trail of who did what, when, and from where in your AWS environment, which is essential for security monitoring and compliance."
                    },
                    {
                        id: 10,
                        type: "multiple-choice",
                        question: "Which CloudTrail event field is most critical for security incident response?",
                        options: [
                            "sourceIPAddress",
                            "responseElements", 
                            "apiVersion",
                            "requestParameters"
                        ],
                        correct: 0,
                        justification: "While all CloudTrail fields provide valuable information, sourceIPAddress is most critical for security incident response as it immediately shows the origin of potentially malicious activity. Combined with eventName, userIdentity, and eventTime, it helps security teams quickly identify and track suspicious activities across their AWS environment."
                    },
                    {
                        id: 11,
                        type: "multiple-choice",
                        question: "Which CloudTrail event would be most suspicious if seen from an unusual IP address?",
                        options: [
                            "AssumeRole or CreateUser",
                            "DescribeInstances",
                            "ListBuckets",
                            "GetSessionToken"
                        ],
                        correct: 0,
                        justification: "AssumeRole and CreateUser are high-privilege operations that can lead to privilege escalation and persistence. These actions from unusual IP addresses are strong indicators of compromise and should trigger immediate investigation."
                    },
                    {
                        id: 12,
                        type: "multiple-choice",
                        question: "What CloudTrail event type indicates someone is trying to cover their tracks by deleting logs?",
                        options: [
                            "StopLogging or DeleteTrail",
                            "CreateTrail",
                            "GetTrailStatus",
                            "DescribeTrails"
                        ],
                        correct: 0,
                        justification: "Events like 'StopLogging' or 'DeleteTrail' indicate attempts to disable or remove audit trails. These are classic indicators of attackers trying to cover their tracks and should trigger immediate security response."
                    }
                ]
            },
            {
                section: "AWS CloudShell and CLI",
                description: "Questions about command-line tools and automation",
                questions: [
                    {
                        id: 13,
                        type: "multiple-choice", 
                        question: "AWS CloudShell is:",
                        options: [
                            "A browser-based shell with pre-installed AWS CLI and other tools",
                            "A desktop application for managing AWS resources",
                            "A mobile app for AWS management",
                            "A database query interface"
                        ],
                        correct: 0,
                        justification: "AWS CloudShell is a browser-based shell environment that comes pre-installed with AWS CLI, SDKs, and other development tools. It provides a convenient way to manage AWS resources without needing to install tools locally."
                    },
                    {
                        id: 14,
                        type: "multiple-choice",
                        question: "What is the primary advantage of using AWS CLI for security investigations?",
                        options: [
                            "Automation and scripting capabilities for consistent procedures",
                            "Better graphical user interface",
                            "Reduced security permissions required", 
                            "Automatic incident response"
                        ],
                        correct: 0,
                        justification: "The primary advantage of AWS CLI for security investigations is automation and scripting capabilities. This enables consistent incident response procedures, supports batch processing for analyzing large datasets, often provides faster access than GUI console, and offers powerful filtering and output formatting options."
                    },
                    {
                        id: 15,
                        type: "multiple-choice",
                        question: "What AWS CLI command would you use to query CloudTrail events for a specific user?",
                        options: [
                            "aws cloudtrail lookup-events",
                            "aws iam get-user-events",
                            "aws logs describe-events",
                            "aws cloudwatch get-user-activity"
                        ],
                        correct: 0,
                        justification: "The 'aws cloudtrail lookup-events' command with appropriate filters (like --lookup-attributes) can query CloudTrail events for specific users, IP addresses, or event types. This is the primary method for investigating user activity through the CLI."
                    },
                    {
                        id: 16,
                        type: "multiple-choice",
                        question: "When writing a script to query CloudTrail for failed login attempts, which parameter would be most important?",
                        options: [
                            "Event name filter for 'ConsoleLogin' with error conditions",
                            "Region specification only",
                            "User name without time constraints",
                            "Resource type filtering"
                        ],
                        correct: 0,
                        justification: "When querying for failed login attempts, filtering by event name 'ConsoleLogin' and looking for error codes or error messages in the CloudTrail events is most important. This helps identify failed authentication attempts that could indicate brute force attacks or unauthorized access attempts."
                    }
                ]
            },
            {
                section: "Security Incident Containment",
                description: "Questions about responding to and containing security events",
                questions: [
                    {
                        id: 17,
                        type: "multiple-choice",
                        question: "What should be the FIRST step when containing a suspected compromised AWS account?",
                        options: [
                            "Rotate credentials and revoke active sessions",
                            "Delete all resources", 
                            "Contact AWS Support",
                            "Create a backup of all data"
                        ],
                        correct: 0,
                        justification: "The first priority in incident containment is to stop the attacker's access by rotating compromised credentials and revoking active sessions. This prevents further damage while preserving evidence for investigation."
                    },
                    {
                        id: 18,
                        type: "multiple-choice",
                        question: "Which is the most effective immediate containment strategy for a compromised IAM user?",
                        options: [
                            "Attach a deny-all policy to the user",
                            "Enable MFA requirement only",
                            "Send email notification to user", 
                            "Increase password complexity requirements"
                        ],
                        correct: 0,
                        justification: "Attaching a deny-all policy to the compromised user is the most effective immediate containment strategy. This immediately blocks all access while preserving the user account for investigation. Other immediate actions should include deactivating access keys, forcing password reset, and removing from all groups."
                    },
                    {
                        id: 19,
                        type: "multiple-choice",
                        question: "When should you isolate an EC2 instance during an incident?",
                        options: [
                            "When you suspect it's compromised but need to preserve evidence",
                            "Only after backing up all data",
                            "Never - always terminate immediately",
                            "Only during business hours"
                        ],
                        correct: 0,
                        justification: "Instance isolation (changing security groups, network ACLs) allows you to preserve evidence for forensic analysis while preventing the compromised instance from communicating with other resources or external networks."
                    },
                    {
                        id: 20,
                        type: "multiple-choice", 
                        question: "What is the first step in a containment plan when an unauthorized user has created new resources?",
                        options: [
                            "Immediately rotate all potentially compromised credentials",
                            "Delete all unauthorized resources first",
                            "Contact AWS support before taking action",
                            "Document the incident without taking action"
                        ],
                        correct: 0,
                        justification: "The first step should be immediately rotating all potentially compromised credentials and revoking active sessions. This stops the attacker's access while preserving evidence. Then proceed with: isolating suspicious resources, taking snapshots for evidence, reviewing CloudTrail logs, removing unauthorized resources, and implementing additional monitoring."
                    }
                ]
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = {};
        let showingJustification = false;

        function initializeQuiz() {
            renderCurrentQuestion();
            updateProgress();
            updateNavigation();
        }

        function renderCurrentQuestion() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            const currentQuestion = getCurrentQuestion();
            if (!currentQuestion) return;

            const questionCard = document.createElement('div');
            questionCard.className = 'question-card active';

            // Check if this is the start of a new section
            const currentSectionIndex = getCurrentSectionIndex();
            const isNewSection = isFirstQuestionInSection();

            let html = '';

            if (isNewSection) {
                const section = quizData[currentSectionIndex];
                html += `
                    <div class="section-header">
                        <h2>${section.section}</h2>
                        <p>${section.description}</p>
                    </div>
                `;
            }

            html += `
                <div class="question">
                    <h3>
                        <span class="question-number">Q${currentQuestion.id}</span>
                        ${currentQuestion.question}
                    </h3>
                    ${renderQuestionInput(currentQuestion)}
                    <div class="justification" id="justification-${currentQuestion.id}">
                        <h4>Explanation:</h4>
                        <p>${currentQuestion.justification}</p>
                    </div>
                </div>
            `;

            questionCard.innerHTML = html;
            container.appendChild(questionCard);

            // Restore user's previous answer if any
            restoreAnswer(currentQuestion);
        }

        function renderQuestionInput(question) {
            // Only multiple choice questions now
            return `
                <div class="options">
                    ${question.options.map((option, index) => `
                        <div class="option" onclick="selectOption(${question.id}, ${index}, 'radio')">
                            <input type="radio" name="q${question.id}" value="${index}" id="q${question.id}_${index}">
                            <label for="q${question.id}_${index}">${option}</label>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function selectOption(questionId, optionIndex, type) {
            const input = document.getElementById(`q${questionId}_${optionIndex}`);
            
            // Only handle radio buttons (MCQ)
            // Clear all options for this question
            document.querySelectorAll(`input[name="q${questionId}"]`).forEach(inp => {
                inp.checked = false;
                inp.closest('.option').classList.remove('selected');
            });
            
            input.checked = true;
            input.closest('.option').classList.add('selected');
            userAnswers[questionId] = optionIndex;
            
            updateNavigation();
        }

        function restoreAnswer(question) {
            const answer = userAnswers[question.id];
            if (answer === undefined) return;

            // Only handle multiple choice (radio buttons)
            const radioInput = document.getElementById(`q${question.id}_${answer}`);
            if (radioInput) {
                radioInput.checked = true;
                radioInput.closest('.option').classList.add('selected');
            }
        }

        function getCurrentQuestion() {
            let questionIndex = 0;
            for (const section of quizData) {
                for (const question of section.questions) {
                    if (questionIndex === currentQuestionIndex) {
                        return question;
                    }
                    questionIndex++;
                }
            }
            return null;
        }

        function getCurrentSectionIndex() {
            let questionIndex = 0;
            for (let sectionIndex = 0; sectionIndex < quizData.length; sectionIndex++) {
                const section = quizData[sectionIndex];
                for (const question of section.questions) {
                    if (questionIndex === currentQuestionIndex) {
                        return sectionIndex;
                    }
                    questionIndex++;
                }
            }
            return 0;
        }

        function isFirstQuestionInSection() {
            let questionIndex = 0;
            for (const section of quizData) {
                if (questionIndex === currentQuestionIndex) {
                    return true;
                }
                for (const question of section.questions) {
                    questionIndex++;
                }
            }
            return false;
        }

        function getTotalQuestions() {
            return quizData.reduce((total, section) => total + section.questions.length, 0);
        }

        function updateProgress() {
            const totalQuestions = getTotalQuestions();
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `Question ${currentQuestionIndex + 1} of ${totalQuestions}`;
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            const totalQuestions = getTotalQuestions();
            const isLastQuestion = currentQuestionIndex === totalQuestions - 1;
            
            if (isLastQuestion) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';
            }
        }

        function nextQuestion() {
            saveCurrentAnswer();
            
            if (!showingJustification) {
                showJustification();
                showingJustification = true;
                document.getElementById('nextBtn').textContent = 'Continue';
            } else {
                const totalQuestions = getTotalQuestions();
                if (currentQuestionIndex < totalQuestions - 1) {
                    currentQuestionIndex++;
                    showingJustification = false;
                    document.getElementById('nextBtn').textContent = 'Next';
                    renderCurrentQuestion();
                    updateProgress();
                    updateNavigation();
                }
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showingJustification = false;
                document.getElementById('nextBtn').textContent = 'Next';
                renderCurrentQuestion();
                updateProgress();
                updateNavigation();
            }
        }

        function saveCurrentAnswer() {
            // No need to save current answer for MCQ as it's handled in selectOption
            return;
        }

        function showJustification() {
            const currentQuestion = getCurrentQuestion();
            if (currentQuestion) {
                const justificationElement = document.getElementById(`justification-${currentQuestion.id}`);
                if (justificationElement) {
                    justificationElement.classList.add('show');
                    
                    // Highlight correct answers
                    highlightCorrectAnswers(currentQuestion);
                }
            }
        }

        function highlightCorrectAnswers(question) {
            // Only handle multiple choice questions
            question.options.forEach((option, index) => {
                const optionElement = document.getElementById(`q${question.id}_${index}`);
                if (optionElement) {
                    const optionDiv = optionElement.closest('.option');
                    if (index === question.correct) {
                        optionDiv.classList.add('correct');
                    } else if (userAnswers[question.id] === index && index !== question.correct) {
                        optionDiv.classList.add('incorrect');
                    }
                }
            });
        }

        function submitQuiz() {
            saveCurrentAnswer();
            calculateScore();
            showScorePage();
        }

        function calculateScore() {
            let totalScore = 0;
            let maxScore = 0;
            const sectionScores = {};

            quizData.forEach(section => {
                sectionScores[section.section] = { score: 0, max: 0 };
                
                section.questions.forEach(question => {
                    maxScore++;
                    sectionScores[section.section].max++;
                    
                    const userAnswer = userAnswers[question.id];
                    let isCorrect = false;

                    // Only multiple choice questions now
                    isCorrect = userAnswer === question.correct;

                    if (isCorrect) {
                        totalScore++;
                        sectionScores[section.section].score++;
                    }
                });
            });

            return {
                totalScore,
                maxScore,
                percentage: Math.round((totalScore / maxScore) * 100),
                sectionScores
            };
        }

        function showScorePage() {
            const scoreData = calculateScore();
            
            // Hide quiz content
            document.querySelector('.quiz-header').style.display = 'none';
            document.getElementById('questionsContainer').style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            
            // Show score page
            const scorePage = document.getElementById('scorePage');
            scorePage.classList.add('show');
            
            // Update score display
            const scoreCircle = document.getElementById('scoreCircle');
            const scorePercentage = document.getElementById('scorePercentage');
            const scoreTitle = document.getElementById('scoreTitle');
            const scoreDescription = document.getElementById('scoreDescription');
            
            scorePercentage.textContent = `${scoreData.percentage}%`;
            
            // Set score category and styling
            if (scoreData.percentage >= 90) {
                scoreCircle.className = 'score-circle score-excellent';
                scoreTitle.textContent = 'Excellent!';
                scoreDescription.textContent = 'Outstanding performance! You have a strong understanding of AWS security tools.';
            } else if (scoreData.percentage >= 75) {
                scoreCircle.className = 'score-circle score-good';
                scoreTitle.textContent = 'Well Done!';
                scoreDescription.textContent = 'Good job! You have a solid grasp of AWS security concepts.';
            } else if (scoreData.percentage >= 60) {
                scoreCircle.className = 'score-circle score-average';
                scoreTitle.textContent = 'Good Effort!';
                scoreDescription.textContent = 'You\'re on the right track. Review the areas below for improvement.';
            } else {
                scoreCircle.className = 'score-circle score-poor';
                scoreTitle.textContent = 'Keep Learning!';
                scoreDescription.textContent = 'Consider reviewing the workshop materials and practice more.';
            }
            
            // Show detailed breakdown
            showScoreBreakdown(scoreData);
            showRecommendations(scoreData);
        }

        function showScoreBreakdown(scoreData) {
            const breakdown = document.getElementById('scoreBreakdown');
            breakdown.innerHTML = `
                <div class="score-item">
                    <h3>Overall Score</h3>
                    <p>${scoreData.totalScore} out of ${scoreData.maxScore} questions correct</p>
                    <p><strong>${scoreData.percentage}%</strong></p>
                </div>
                ${Object.entries(scoreData.sectionScores).map(([section, data]) => `
                    <div class="score-item">
                        <h4>${section}</h4>
                        <p>${data.score} / ${data.max} correct</p>
                        <p><strong>${Math.round((data.score / data.max) * 100)}%</strong></p>
                    </div>
                `).join('')}
            `;
        }

        function showRecommendations(scoreData) {
            const recommendations = document.getElementById('recommendations');
            
            let recommendationText = '<h3>📚 Recommendations for Further Learning</h3><ul>';
            
            // Analyze weak areas
            const weakAreas = Object.entries(scoreData.sectionScores)
                .filter(([section, data]) => (data.score / data.max) < 0.7)
                .map(([section, data]) => section);
            
            if (weakAreas.length === 0) {
                recommendationText += `
                    <li>🎉 Excellent work across all areas!</li>
                    <li>Consider advanced AWS security topics like GuardDuty, Security Hub, and Config</li>
                    <li>Explore AWS security automation with Lambda and EventBridge</li>
                    <li>Practice hands-on labs for real-world scenarios</li>
                `;
            } else {
                if (weakAreas.includes('AWS CloudFormation')) {
                    recommendationText += `
                        <li>📖 Review AWS CloudFormation documentation and templates</li>
                        <li>🔧 Practice creating and managing CloudFormation stacks</li>
                        <li>🎯 Study Infrastructure as Code best practices</li>
                    `;
                }
                
                if (weakAreas.includes('Amazon Athena and Log Analysis')) {
                    recommendationText += `
                        <li>📊 Practice SQL queries with Athena on sample datasets</li>
                        <li>🔍 Learn about log analysis patterns and IoC identification</li>
                        <li>📈 Study security monitoring and alerting strategies</li>
                    `;
                }
                
                if (weakAreas.includes('AWS CloudTrail Events')) {
                    recommendationText += `
                        <li>📋 Study CloudTrail event structure and key fields</li>
                        <li>🚨 Practice identifying suspicious activities in logs</li>
                        <li>⚙️ Learn CloudTrail configuration and best practices</li>
                    `;
                }
                
                if (weakAreas.includes('AWS CloudShell and CLI')) {
                    recommendationText += `
                        <li>💻 Practice AWS CLI commands for security operations</li>
                        <li>📝 Learn scripting for automated security tasks</li>
                        <li>🔧 Explore CloudShell features and capabilities</li>
                    `;
                }
                
                if (weakAreas.includes('Security Incident Containment')) {
                    recommendationText += `
                        <li>🚨 Study incident response frameworks and procedures</li>
                        <li>🔒 Practice containment strategies for different scenarios</li>
                        <li>📚 Review AWS security incident response playbooks</li>
                    `;
                }
            }
            
            recommendationText += `
                <li>🎓 Consider AWS Security Specialty certification</li>
                <li>🔗 Join AWS security communities and forums</li>
                <li>📖 Regularly review AWS Security Blog and whitepapers</li>
            </ul>`;
            
            recommendations.innerHTML = recommendationText;
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = {};
            showingJustification = false;
            
            // Show quiz content
            document.querySelector('.quiz-header').style.display = 'block';
            document.getElementById('questionsContainer').style.display = 'block';
            document.querySelector('.navigation').style.display = 'block';
            
            // Hide score page
            document.getElementById('scorePage').classList.remove('show');
            
            // Reset navigation
            document.getElementById('nextBtn').textContent = 'Next';
            
            // Restart quiz
            initializeQuiz();
        }

        // Initialize the quiz when page loads
        document.addEventListener('DOMContentLoaded', initializeQuiz);
    </script>
</body>
</html>